---
title: "Scrap Paper"
format: html
editor: visual
---

# 1/6 Simulating game design of Leftist Infighting Game (not for class)

```{r}
M = 4 #Missing capacity.
T = 4 #Turns over which capacity is missing.

Pc = ((M / 6)^3) #Probability of collapse in a turn.
Ps = (1 - Pc) #Probability of survival in a given turn.
Pct = (1 - (1 - Pc)^T) #Probability of collapse in t turns.
```

We can solve for M given T and Pct:

Pct = (1 - (1 - Pc)^T)
1 - Pct = (1 - Pc)^T
(1 - Pct)^(1/T) = 1 - Pc
1 - ((1 - Pct)^(1/T)) = (M/6)^3
6 * (1 - ((1 - Pct)^(1/T)))^(1/3) = M


```{r}
#Find the amount of damage necessary given a certain number of turns and a certain percentage chance. 
Pct = .8
T = 3
M = 6 * (1 - ((1 - Pct)^(1/T)))^(1/3)
```

And we can also solve for T. 

Pct = 1 - (1 - Pc)^T
1 - Pct = (1 - Pc)^T
log(1 - Pct, 1 - Pc) = T

```{r}
#Find the amount of turns required to reach a certain risk of collapse within that time period. 
T = log(1 - Pct, 1 - ((M / 6)^3))
T
```

```{r}
pct_and_T_to_M = function(T, Pct)
  (6 * (1 - ((1 - Pct)^(1/T)))^(1/3))
turns = c(1:15)
pct80_curve = pct_and_T_to_M(turns, .8)
pct50_curve = pct_and_T_to_M(turns, .5)
pct80_curve
pct50_curve
```

Marginal increases in M can be modeled at a range of values of T with the function MarginalM. 

```{r}
MarginalM = function(M, T){
  Pc1 = ((M / 6)^3) #Probability of collapse in a turn.
  Pct1 = (1 - (1 - Pc1)^T) #Probability of collapse in t turns.
  Pc2 = (((M + 1) / 6)^3) #Probability of collapse in one turn with a one-unit increase in M. 
  Pct2 = (1 - (1 - Pc2)^T) #Probability of collapse with a one-unit increase in M. 
  Pct2 - Pct1
}

turns = c(1:15)
MarginalM(3,turns)

marginal_effect_of_damage_done_1 = as.data.frame(cbind(turns, MarginalM(1, turns)))
marginal_effect_of_damage_done_2 = as.data.frame(cbind(turns, MarginalM(2, turns)))
marginal_effect_of_damage_done_3 = as.data.frame(cbind(turns, MarginalM(3, turns)))
marginal_effect_of_damage_done_4 = as.data.frame(cbind(turns, MarginalM(4, turns)))
marginal_effect_of_damage_done_5 = as.data.frame(cbind(turns, MarginalM(5, turns)))

ggplot(marginal_effect_of_damage_done_5, aes(x = turns, y = V2)) +
  geom_point() +
  geom_smooth()


```


```{r}
pct80_plottable_curve = as.data.frame(cbind(turns, pct80_curve))
pct50_plottable_curve = as.data.frame(cbind(turns, pct50_curve))
```

```{r}
ggplot(pct80_plottable_curve, aes(x = turns, y = pct80_curve)) +
  geom_point() +
  geom_smooth()
ggplot(pct50_plottable_curve, aes(x = turns, y = pct50_curve)) +
  geom_point() +
  geom_smooth()
```



# 1/7 Readings: Mouse Scatterplot

```{r}
library(ggplot2)
# try https:// if you get an error message when loading data from the URL.
mouse_phenomes = read.csv("/Users/gideon/Desktop/Datasets/mouse-phenomedoc.csv")
```

```{r}
str(mouse_phenomes)
```

```{r}
sort(table(mouse_phenomes$strain))
```
```{r}
table(mouse_phenomes$strain, mouse_phenomes$sex)
```

```{r}
ggplot(data=mouse_phenomes, mapping = aes(x = pctRetic, y = RBC)) +
  geom_point()
```

```{r}
ggplot(data=mouse_phenomes, mapping = aes(x = pctRetic, y = RBC)) +
  geom_point() +
  geom_smooth(method = "lm")
```

Note that this is a change from the default, which is `loess`. We can remove the confidence interval with `se = FALSE`. 

```{r}
cor(x=mouse_phenomes$RBC, y=mouse_phenomes$pctRetic, use = "complete.obs")
```

```{r}
ggplot(data=mouse_phenomes, mapping = aes(x = pctRetic, y = RBC)) +
  geom_point(aes(color = sex))
```

```{r}
ggplot(data=mouse_phenomes, mapping = aes(x = pctRetic, y = RBC, color = sex)) +
  geom_point() +
  geom_smooth(method = "lm")
```

```{r}
t.test(x = mouse_phenomes[mouse_phenomes$sex == "f", "RBC"], y = mouse_phenomes[mouse_phenomes$sex == "m", "RBC"])
```

```{r}
ggplot(data=mouse_phenomes, mapping = aes(x = pctRetic, y = RBC, color = sex)) +
  geom_point() +
  geom_smooth(method = "lm") +
  facet_wrap(~ sex) +
  xlab("percent reticulocytes") +
  ylab("red blood cell count (n/uL)") +
  ggtitle("Red Blood Cell Count by Percent Reticulocytes")
```


```{r}
panel.cor <- function(x, y, digits = 2, prefix = "", cex.cor, ...)
{
    usr <- par("usr"); on.exit(par(usr))
    par(usr = c(0, 1, 0, 1))
    r <- abs(cor(x, y, use = "complete.obs"))
    txt <- format(c(r, 0.123456789), digits = digits)[1]
    txt <- paste0(prefix, txt)
    if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt)
    text(0.5, 0.5, txt, cex = cex.cor * r)
}

panel.hist <- function(x, ...)
{
    usr <- par("usr"); on.exit(par(usr))
    par(usr = c(usr[1:2], 0, 1.5) )
    h <- hist(x, plot = FALSE)
    breaks <- h$breaks; nB <- length(breaks)
    y <- h$counts; y <- y/max(y)
    rect(breaks[-nB], 0, breaks[-1], y, col = "cyan", ...)
}

```

```{r}
pairs(mouse_phenomes[,5:8],
	upper.panel = panel.cor, diag.panel = panel.hist)
```

```{r}
ggplot(mouse_phenomes, mapping = aes(CHOL, systolic_BP)) +
  geom_point() +
  geom_smooth(method = "lm")
```

